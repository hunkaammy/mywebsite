<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Voice Input Addition</title>
</head>
<body>

<h1>Voice Input Addition</h1>

<button onclick="startSpeechRecognition()">Activate Microphone</button>

<p id="recognizedText">Recognized Text:</p>

<div id="realTimeText">Real-Time Recognized Text: </div>
<p> v0.3 </p>
<script>
let realTimeRecognizedText = ''; // Variable to store real-time recognized text
let recognition = null;

// Function to start speech recognition
function startSpeechRecognition() {
    recognition = new window.webkitSpeechRecognition(); // Create a new instance of SpeechRecognition
    recognition.lang = 'en-US'; // Set recognition language to English (United States)
    recognition.interimResults = true; // Allow interim results

    recognition.onstart = function() {
        console.log('Speech recognition started');
    };

    recognition.onresult = function(event) {
        const transcript = event.results[0][0].transcript;
        console.log('Transcript:', transcript);

        // Update real-time recognized text
        realTimeRecognizedText = transcript;
        document.getElementById('realTimeText').textContent = 'Real-Time Recognized Text: ' + realTimeRecognizedText;

        const numbers = parseNumbers(transcript);
        if (numbers.length > 0) {
            const sum = addNumbers(numbers);
            alert('Sum: ' + sum);
        } else {
            alert('No numbers found in the speech');
        }
    };

    recognition.onerror = function(event) {
        console.error('Speech recognition error:', event.error);
        if (event.error === 'not-allowed') {
            alert('Microphone access is not allowed. Please grant permission and try again.');
        }
    };

    recognition.onend = function() {
        console.log('Speech recognition ended');
    };

    recognition.start(); // Start recognition
}

// Function to parse numbers from text
function parseNumbers(text) {
    const numberRegex = /(?:\d{1,3}(?:,\d{3})+|\d+)/g; // Regular expression to match numbers with or without thousands separators
    const matches = text.match(numberRegex);
    return matches ? matches.map(parseFloat) : [];
}

// Function to add numbers in an array
function addNumbers(numbers) {
    return numbers.reduce((sum, num) => sum + num, 0);
}
</script>

</body>
</html>
