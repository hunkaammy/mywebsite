<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-time Edit Data in Firebase</title>
    <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css'>
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css'>
    <link rel='stylesheet' href='https://fezvrasta.github.io/bootstrap-material-design/dist/css/bootstrap-material-design.css'>
    <link rel='stylesheet' href='https://fezvrasta.github.io/bootstrap-material-design/dist/css/ripples.min.css'>
<style>
    /* Style for non-editable state */
    .field {
        border: none;
        padding: 5px;
        background-color: transparent;
        width: 100%;
        font-size: 14px;
        box-sizing: border-box;
        resize: none; /* Disable resizing */
        overflow: hidden; /* Hide overflow */
        line-height: 1.5; /* Adjust line height as needed */
    }

    /* Style for editable state */
    .editable {
        border: 1px solid #66afe9;
        background-color: #fff;
        font-size: 14px;
        padding: 5px;
        box-sizing: border-box;
        resize: vertical; /* Allow vertical resizing */
        overflow: auto; /* Enable scrollbars if content exceeds */
        line-height: 1.5; /* Adjust line height as needed */
    }

    /* More width for the first field */
    .first-field {
    width: 234%;
    max-width: 278%;
}

    /* Responsive table styles */
    @media (max-width: 767px) {
        table {
            width: 100%;
            max-width: 100%;
            overflow-x: auto;
            display: block;
            table-layout: auto; /* Allow columns to adjust based on content */
        }
        th, td {
            white-space: normal; /* Allow normal wrapping */
            word-wrap: break-word; /* Ensure word breaks */
        }
    }
</style>






    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.2.0/firebase-app.js";
        import { getDatabase, ref, onValue, update, remove } from "https://www.gstatic.com/firebasejs/9.2.0/firebase-database.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAMFjDnZaszneoR6nO8bmXUxwZJplLvNfU",
            authDomain: "notes-12519.firebaseapp.com",
            databaseURL: "https://notes-12519-default-rtdb.firebaseio.com",
            projectId: "notes-12519",
            storageBucket: "notes-12519.appspot.com",
            messagingSenderId: "1073774450189",
            appId: "1:1073774450189:web:0b6d4a9f95823abbf36744",
            measurementId: "G-GZXYCJ33TR"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // DOM element
        const dataContainer = document.getElementById('data-container');

        // Fetch and display data
        const dataRef = ref(database);
        onValue(dataRef, (snapshot) => {
            const data = snapshot.val();
            
            // Update the DOM only with changed data
            for (let key in data) {
                if (data.hasOwnProperty(key)) {
                    let entryDiv = document.getElementById(key);
                    if (!entryDiv) {
                        entryDiv = document.createElement('div');
                        entryDiv.id = key;

                        entryDiv.innerHTML = `
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>
                                            <textarea class="field first-field" data-id="${key}" data-field="field2" readonly
    onclick="enableEditing(event, '${key}', 'field2')"
    onblur="disableEditing(event, '${key}', 'field2')"
    oninput="handleInputChange(event, '${key}', 'field2')">${data[key].field2}</textarea>


                                        </th>
                                        <th><img src="${data[key].field1}" alt="Image" width="150" height="150"></th>
                                        <th>
                                            <input type="text" class="field" value="${data[key].field3}" data-id="${key}" data-field="field3" readonly
                                                onclick="enableEditing(event, '${key}', 'field3')"
                                                onblur="disableEditing(event, '${key}', 'field3')"
                                                oninput="handleInputChange(event, '${key}', 'field3')">
                                        </th>
                                        <th><button onclick="deleteData('${key}')">Delete</button></th>
                                        <th><a href="https://hunkaammy.github.io/mywebsite/NEWWEBSITE/new#myInput=${data[key].field2}" target="_blank">This is a link</a></th>
                                    </tr>
                                </thead>
                            </table>
                        `;
                        dataContainer.appendChild(entryDiv);
                    } else {
                        entryDiv.querySelector(`input[data-field="field2"]`).value = data[key].field2;
                        entryDiv.querySelector(`input[data-field="field3"]`).value = data[key].field3;
                    }
                }
            }
        });

        // Function to handle input change and update Firebase
        window.handleInputChange = function (event, key, field) {
            const updates = {};
            updates[field] = event.target.value;

            // Update Firebase without re-rendering the entire DOM
            const dataRef = ref(database, key);
            update(dataRef, updates);
        };

        // Enable editing of the input field
        window.enableEditing = function (event, key, field) {
            const inputField = event.target;
            inputField.classList.add('editable');
            inputField.readOnly = false;
            inputField.focus();
        };

        // Disable editing of the input field
        window.disableEditing = function (event, key, field) {
            const inputField = event.target;
            inputField.classList.remove('editable');
            inputField.readOnly = true;
        };

        // Delete data
        window.deleteData = function (key) {
            const dataRef = ref(database, key);
            remove(dataRef);
        };
    </script>
</head>

<body>
    <div id="data-container"></div>
</body>

</html>
